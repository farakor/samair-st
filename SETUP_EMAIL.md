# Настройка почты для Samair Admin

## Запуск приложения

Убедитесь, что у вас запущены оба сервера:

1. **Фронтенд (React):**
   ```bash
   npm start
   ```
   Работает на http://localhost:3000

2. **Бэкенд (Node.js API):**
   ```bash
   npm run server
   # или
   node server/server.js
   ```
   Работает на http://localhost:3001

**Или запустите оба одновременно:**
```bash
npm run dev
```

## Решение проблем

### Ошибка "Failed to fetch"
**Причина:** Серверное приложение не запущено
**Решение:** Запустите серверное приложение командой `npm run server`

### Ошибка аутентификации IMAP
**Причина:** Неверные учетные данные или настройки сервера
**Возможные решения:**

1. **Проверьте настройки сервера для reg.ru:**
   - Хост: `scp116.hosting.reg.ru` (ваш текущий сервер)
   - Порт: `993` (SSL) или `143` (без SSL)
   - Email: полный email адрес
   - TLS/SSL: включен для порта 993

2. **Альтернативные настройки для reg.ru:**
   - Попробуйте `mail.dfs24.ru` как хост
   - Убедитесь, что IMAP включен в панели управления хостингом

3. **Проверьте пароль:**
   - Убедитесь, что используете правильный пароль от почты
   - Для некоторых провайдеров нужны "пароли приложений"

## Настройки IMAP

### Рекомендуемые настройки для разных провайдеров:

**Gmail:**
- Хост: `imap.gmail.com`
- Порт: `993`
- TLS: включен
- Пароль: пароль приложения (не основной пароль)

**Yandex:**
- Хост: `imap.yandex.ru`
- Порт: `993`
- TLS: включен

**Mail.ru:**
- Хост: `imap.mail.ru`
- Порт: `993`
- TLS: включен

**Reg.ru (ваш хостинг):**
- Хост: `scp116.hosting.reg.ru` или `mail.yourdomain.ru`
- Порт: `993` (SSL) / `143` (без SSL)
- TLS: включен для 993, отключен для 143

## Диагностика

1. **Проверьте доступность API:**
   ```bash
   curl http://localhost:3001/api/email-config
   ```

2. **Тестирование подключения через curl:**
   ```bash
   curl -X POST http://localhost:3001/api/test-email-connection \
     -H "Content-Type: application/json" \
     -d '{"host":"ваш_хост","port":993,"user":"email@domain.ru","password":"пароль","tls":true}'
   ```

3. **Проверьте логи сервера** в терминале для детальной информации об ошибках

## Автоматический сбор писем

После успешной настройки IMAP:
- Система автоматически проверяет почту каждый день в 9:00
- Обрабатывает только письма с Excel вложениями за последние 7 дней
- Сохраняет файлы в базу данных для дальнейшей обработки

## Поддержка

Если проблемы не решаются:
1. Проверьте настройки IMAP в панели управления хостингом
2. Убедитесь, что IMAP протокол разрешен
3. Попробуйте создать новый пароль для почтового ящика 