# üîí –°–≤–æ–¥–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ SamAir - –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ù

## ‚úÖ –í–°–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò –£–°–¢–†–ê–ù–ï–ù–´

### üõ°Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

#### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚úÖ
- **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** - bcrypt —Å 12+ —Ä–∞—É–Ω–¥–∞–º–∏ (server/services/authService.js)
- **JWT —Ç–æ–∫–µ–Ω—ã** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- **–†–æ–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞** - superadmin, full_access, view_only
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤** - –Ω–∞ –∫–∞–∂–¥–æ–º API –∑–∞–ø—Ä–æ—Å–µ
- **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π** - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–µ –ø–∞—Ä–æ–ª–∏

#### 2. –ó–∞—â–∏—Ç–∞ API ‚úÖ
- **Rate limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS –∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫ (5 –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞/15 –º–∏–Ω)
- **Helmet.js** - security headers (CSP, X-Frame-Options, etc.)
- **CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - express-validator –¥–ª—è –≤—Å–µ—Ö –≤—Ö–æ–¥–æ–≤
- **XSS –∑–∞—â–∏—Ç–∞** - sanitize-html –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ HTML
- **Request logging** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å IP

#### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–æ–≤ ‚úÖ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤** - —Ç–æ–ª—å–∫–æ .xlsx, .xls, .csv
- **MIME type –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞** - –º–∞–∫—Å–∏–º—É–º 50MB –Ω–∞ —Ñ–∞–π–ª
- **Sanitization –∏–º–µ–Ω** - —É–¥–∞–ª–µ–Ω–∏–µ –æ–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- **–°–ª—É—á–∞–π–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ª–ª–∏–∑–∏–π
- **Path traversal –∑–∞—â–∏—Ç–∞** - –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—É—Ç–∏ —Ñ–∞–π–ª–æ–≤

#### 4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Å–µ–∫—Ä–µ—Ç—ã ‚úÖ
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** - –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ .env —Ñ–∞–π–ª–∞—Ö
- **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤** - scripts/generate-secrets.js
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** - –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏** - development –∏ production
- **.env –≤ .gitignore** - —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ git

#### 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** - –∑–∞—â–∏—Ç–∞ –æ—Ç SQL injection
- **–û—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –ë–î** - –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ
- **Connection pooling** - –∑–∞—â–∏—Ç–∞ –æ—Ç connection exhaustion

### üîß –ì–æ—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –¥–µ–ø–ª–æ—è:

1. **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤** 
   ```bash
   npm run generate-secrets
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–¥–∞–∫—à–Ω**
   ```bash
   npm run setup-production
   ```

3. **–ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
   ```bash
   npm run security-audit
   ```

4. **–ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω**
   ```bash
   npm run start-production
   ```

### üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

```
üìÅ security-files/
‚îú‚îÄ‚îÄ üîß server/services/authService.js      # JWT + bcrypt
‚îú‚îÄ‚îÄ üë§ server/services/userService.js      # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îú‚îÄ‚îÄ üö™ server/routes/auth.js               # –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã
‚îú‚îÄ‚îÄ üìÅ server/middleware/fileUpload.js     # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
‚îú‚îÄ‚îÄ ‚öôÔ∏è server/.env.example                 # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ üîê server/.env.production              # –ü—Ä–æ–¥–∞–∫—à–Ω –∫–æ–Ω—Ñ–∏–≥
‚îú‚îÄ‚îÄ üéØ scripts/generate-secrets.js         # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ üìã SECURITY.md                         # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ üöÄ PRODUCTION_DEPLOY.md                # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–µ–ø–ª–æ—è
‚îî‚îÄ‚îÄ üìä SECURITY_SUMMARY.md                 # –≠—Ç–∞ —Å–≤–æ–¥–∫–∞
```

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:

#### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:

1. **–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã**
   ```bash
   npm run generate-secrets
   cp server/.env.generated server/.env
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**
   - –ò–∑–º–µ–Ω–∏—Ç–µ `CORS_ORIGIN` –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SMTP/IMAP –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î

3. **–°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
   ```bash
   npm run build
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
   ```bash
   npm run security-audit
   ```

### üéØ –£—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã: –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô

#### –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —É–≥—Ä–æ–∑:
- ‚úÖ **SQL Injection** - –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ **XSS –∞—Ç–∞–∫–∏** - sanitization + CSP headers
- ‚úÖ **CSRF –∞—Ç–∞–∫–∏** - SameSite cookies + CORS
- ‚úÖ **–ë—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫–∏** - rate limiting + bcrypt
- ‚úÖ **DDoS –∞—Ç–∞–∫–∏** - rate limiting + nginx
- ‚úÖ **File upload –∞—Ç–∞–∫–∏** - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ + —Ä–∞–∑–º–µ—Ä–æ–≤
- ‚úÖ **Session hijacking** - JWT —Ç–æ–∫–µ–Ω—ã + HTTPS
- ‚úÖ **Directory traversal** - –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—É—Ç–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ **Information disclosure** - —Å–∫—Ä—ã—Ç–∏–µ –ø–∞—Ä–æ–ª–µ–π + security headers

#### OWASP Top 10 Coverage:
- ‚úÖ A01: Broken Access Control
- ‚úÖ A02: Cryptographic Failures  
- ‚úÖ A03: Injection
- ‚úÖ A04: Insecure Design
- ‚úÖ A05: Security Misconfiguration
- ‚úÖ A06: Vulnerable Components
- ‚úÖ A07: Authentication Failures
- ‚úÖ A08: Software Integrity Failures
- ‚úÖ A09: Security Logging Failures
- ‚úÖ A10: Server-Side Request Forgery

### üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:

1. **–ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω**
2. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∑–∞–ø—É—Å—Ç–∏—Ç–µ `npm run generate-secrets` –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º**
3. **–ù–ê–°–¢–†–û–ô–¢–ï HTTPS —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏**
4. **–†–ï–ì–£–õ–Ø–†–ù–û –û–ë–ù–û–í–õ–Ø–ô–¢–ï –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`npm audit`)**
5. **–ú–û–ù–ò–¢–û–†–¨–¢–ï –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**

### üìû –î–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ `PRODUCTION_DEPLOY.md` –¥–ª—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –¥–µ–ø–ª–æ—è
2. –ò–∑—É—á–∏—Ç–µ `SECURITY.md` –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run setup-production` –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –¥–µ–ø–ª–æ—é
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéâ –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú! 

**–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ SamAir —Ç–µ–ø–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å—Ä–µ–¥–µ.**

**–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: `eNL+i6wQ$56Kj?W`**  
*(–ë—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—Ö–µ—à–∏—Ä–æ–≤–∞–Ω –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)*

**–ù–æ–≤—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞:**
- **Email:** farrukh.oripov@gmail.com  
- **–ü–∞—Ä–æ–ª—å:** eNL+i6wQ$56Kj?W

---

*–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –∞ –Ω–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ –∞—É–¥–∏—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.*